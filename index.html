<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ðŸšš Solana France - Dashboard Logistique PRO</title>
  <style>/* STYLES identiques - raccourci */</style>
</head>
<body>

<div id="loginScreen" style="position:fixed;top:0;left:0;width:100%;height:100%;background:#00b4d8;display:flex;align-items:center;justify-content:center;">
  <div style="background:#fff;padding:50px;border-radius:24px;box-shadow:0 30px 60px rgba(0,0,0,.3);text-align:center;max-width:450px;">
    <h1 style="color:#0077b6;font-size:2.5rem;margin-bottom:20px;">Solana Logistique PRO</h1>
    <input id="pwdInput" type="password" placeholder="Tapez: solana123" style="width:100%;padding:20px;border:2px solid #ddd;border-radius:12px;font-size:18px;margin-bottom:20px;">
    <button onclick="checkLogin()" style="width:100%;padding:18px;background:#10b981;color:white;border:none;border-radius:12px;font-size:18px;font-weight:bold;cursor:pointer;">ðŸ”“ ENTRER</button>
    <p style="margin-top:20px;color:#666;">Login: <strong>solana123</strong></p>
  </div>
</div>

<div id="dashboard" style="display:none;padding:30px;max-width:1400px;margin:auto;">
  <div style="background:#fff;padding:30px;border-radius:20px;box-shadow:0 20px 40px rgba(0,0,0,.1);margin-bottom:30px;">
    <h1 style="color:#0077b6;">ðŸ“Š Dashboard Chargements</h1>
    <button onclick="logout()" style="background:#ef4444;color:white;border:none;padding:12px 24px;border-radius:12px;float:right;">DÃ©connexion</button>
  </div>

  <!-- FORM AJOUT -->
  <div style="background:#fff;padding:30px;border-radius:20px;margin-bottom:30px;box-shadow:0 15px 35px rgba(0,0,0,.1);">
    <h2 style="color:#0077b6;margin-bottom:20px;">âž• Ajouter commande</h2>
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;">
      <input id="client" placeholder="Client" style="padding:15px;border:2px solid #ddd;border-radius:10px;">
      <input id="ref" placeholder="RÃ©f commande" style="padding:15px;border:2px solid #ddd;border-radius:10px;">
      <input id="date" type="date" style="padding:15px;border:2px solid #ddd;border-radius:10px;">
      <input id="pointDepart" placeholder="Point dÃ©part (76)" style="padding:15px;border:2px solid #ddd;border-radius:10px;">
      <input id="tonnes" type="number" placeholder="Tonnes" step="0.01" style="padding:15px;border:2px solid #ddd;border-radius:10px;">
      <input id="immat" placeholder="Immatriculation AB-123" style="padding:15px;border:2px solid #ddd;border-radius:10px;">
      <input id="emailC" placeholder="Email client" style="padding:15px;border:2px solid #ddd;border-radius:10px;">
      <button onclick="ajoutCmd()" style="padding:20px;background:#10b981;color:white;border:none;border-radius:12px;font-size:16px;font-weight:bold;grid-column:1/-1;">âž• AJOUTER</button>
    </div>
  </div>

  <!-- KPI -->
  <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin-bottom:30px;">
    <div style="background:#fff;padding:25px;border-radius:16px;text-align:center;box-shadow:0 10px 25px rgba(0,0,0,.1);">
      <div id="totalT" style="font-size:3rem;color:#0077b6;font-weight:bold;">0 T</div>
      <div>Total tonnes</div>
    </div>
    <div style="background:#fff;padding:25px;border-radius:16px;text-align:center;box-shadow:0 10px 25px rgba(0,0,0,.1);">
      <div id="attente" style="font-size:3rem;color:#f59e0b;font-weight:bold;">0</div>
      <div>En attente</div>
    </div>
    <div style="background:#fff;padding:25px;border-radius:16px;text-align:center;box-shadow:0 10px 25px rgba(0,0,0,.1);">
      <div id="chargees" style="font-size:3rem;color:#10b981;font-weight:bold;">0</div>
      <div>ChargÃ©es</div>
    </div>
    <div style="background:#fff;padding:25px;border-radius:16px;text-align:center;box-shadow:0 10px 25px rgba(0,0,0,.1);">
      <div id="emailsEnv" style="font-size:3rem;color:#3b82f6;font-weight:bold;">0</div>
      <div>Emails</div>
    </div>
  </div>

  <!-- TABLEAU -->
  <div style="background:#fff;border-radius:20px;overflow:hidden;box-shadow:0 20px 40px rgba(0,0,0,.15);">
    <div style="padding:30px;background:#f8fafc;border-bottom:3px solid #e5e7eb;">
      <h2 style="color:#0077b6;font-size:1.8rem;">ðŸ“‹ Commandes</h2>
    </div>
    <table style="width:100%;border-collapse:collapse;">
      <thead>
        <tr style="background:#f1f5f9;">
          <th style="padding:20px;font-weight:700;">Client</th>
          <th style="padding:20px;font-weight:700;">RÃ©f</th>
          <th style="padding:20px;font-weight:700;">Date</th>
          <th style="padding:20px;font-weight:700;">Point dÃ©part</th>
          <th style="padding:20px;font-weight:700;">Tonnes</th>
          <th style="padding:20px;font-weight:700;">Immat.</th>
          <th style="padding:20px;font-weight:700;">Statut</th>
          <th style="padding:20px;font-weight:700;">Action</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
  </div>
</div>

<script>
let data = JSON.parse(localStorage.getItem('solanaData')) || [];

function checkLogin() {
  if (document.getElementById('pwdInput').value === 'solana123') {
    document.getElementById('loginScreen').style.display = 'none';
    document.getElementById('dashboard').style.display = 'block';
    refresh();
  } else {
    alert('Mot de passe: solana123');
  }
}

function logout() {
  document.getElementById('loginScreen').style.display = 'flex';
  document.getElementById('dashboard').style.display = 'none';
  document.getElementById('pwdInput').value = '';
}

function ajoutCmd() {
  const cmd = {
    client: document.getElementById('client').value,
    ref: document.getElementById('ref').value,
    date: document.getElementById('date').value,
    pointDepart: document.getElementById('pointDepart').value,
    tonnes: parseFloat(document.getElementById('tonnes').value),
    immat: document.getElementById('immat').value,
    emailC: document.getElementById('emailC').value,
    statut: 'EN ATTENTE'
  };

  data.unshift(cmd);
  localStorage.setItem('solanaData', JSON.stringify(data));

  document.getElementById('client').value = '';
  // ... reset autres

  refresh();
  alert('âœ… AjoutÃ©e!');
}

function marquerCharge(id) {
  const cmd = data.find(c => c.ref === id);
  cmd.statut = 'CHARGÃ‰E';

  const sujet = `âœ… ${cmd.ref.toUpperCase()} CHARGÃ‰E - Solana France`;
  const corps = `
${cmd.client},

Commande ${cmd.ref} **CHARGÃ‰E**!

DÃ‰TAILS:
NUMÃ‰RO: ${cmd.ref}
TONNES: ${cmd.tonnes}
POINT DÃ‰PART: ${cmd.pointDepart}
IMMATRICULATION: ${cmd.immat}
DATE: ${new Date().toLocaleDateString('fr-FR')}

Suivi: https://solana1france.github.io/solana-suivi-logistique/

Solana France
logistique@solana.de | +33 6 80 25 82 69
www.solana.de
  `;

  window.location.href = `mailto:${cmd.emailC}?subject=${encodeURIComponent(sujet)}&body=${encodeURIComponent(corps)}`;

  localStorage.setItem('solanaData', JSON.stringify(data));
  refresh();
}

function refresh() {
  const attente = data.filter(c => c.statut === 'EN ATTENTE').length;
  const chargees = data.filter(c => c.statut === 'CHARGÃ‰E').length;
  const totalT = data.reduce((s,c) => s + (c.tonnes||0), 0);

  document.getElementById('totalT').innerHTML = totalT.toFixed(1) + ' T';
  document.getElementById('attente').textContent = attente;
  document.getElementById('chargees').textContent = chargees;
  document.getElementById('emailsEnv').textContent = chargees;

  const tbody = document.getElementById('tableBody');
  tbody.innerHTML = '';
  data.forEach(cmd => {
    const tr = document.createElement('tr');
    tr.style.background = cmd.statut === 'CHARGÃ‰E' ? '#f0fdf4' : '#fff';
    tr.innerHTML = `
      <td style="font-weight:bold;">${cmd.client}</td>
      <td>${cmd.ref}</td>
      <td>${cmd.date}</td>
      <td>${cmd.pointDepart}</td>
      <td><strong>${cmd.tonnes} T</strong></td>
      <td>${cmd.immat}</td>
      <td style="font-weight:bold;color:${cmd.statut === 'CHARGÃ‰E' ? '#10b981' : '#f59e0b'}">${cmd.statut}</td>
      <td>
        ${cmd.statut === 'EN ATTENTE' ? 
          `<button onclick="marquerCharge('${cmd.ref}')" style="background:#00b4d8;color:white;padding:10px 20px;border:none;border-radius:8px;cursor:pointer;">CHARGER & EMAIL</button>` :
          'âœ“ EMAIL envoyÃ©'
        }
      </td>
    `;
    tbody.appendChild(tr);
  });
}

// TEST DATA
if (data.length === 0) {
  data = [{
    client: 'SOBRAL', ref: 'JS26-17', date: '2026-01-07', pointDepart: '76', tonnes: 5, immat: 'AB-123-CD', emailC: 'sobral@solana.de', statut: 'EN ATTENTE'
  }];
  localStorage.setItem('solanaData', JSON.stringify(data));
}

refresh();
</script>
</body>
</html>
